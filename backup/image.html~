{% extends "template.html" %}

{% block includes %}
    <link rel="stylesheet" href="../static_media/css/bootstrap.css">
    <link rel="stylesheet" href="../static_media/css/bootstrap-theme.css">
    <link rel="stylesheet" href="../static_media/css/main.css">\
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script  src="../static_media/js/bootstrap.js"></script>
    <script src="../static_media/js/sortable.js"></script>
    <script src="../static_media/js/main.js"></script>
{% endblock %}

{% block header %}
<span style="display: none;" id="image_id">{{ ID }}</span>
<div class="tab_content tab1" style="padding-left:20px;padding-top:15px;background-color:#EEE;padding-bottom:12px;">
    <div id="dialerdiv1" style="float: left; width: 205px;">
	<p><span class="h2 imageTitle">{{ image.name }}</span><span class="h5 imageVersion"> : {{ image.version }}</span></p>
    </div>
    <div id="dialerdiv2" style="float: left; width:455px">
    	<div class="codeDiv" style="margin-left:6px">
    		<p style="margin-left:10px;font-size:8pt;"> sudo docker pull {{ url }}/{{ image.user }}/{{ image.name }}:{{ image.version }}</p>
    	</div>
    </div>
    <div id="dialerdiv3" style="float: left; width:250px; padding-left:20px; padding-top:1px;">
        <button type="button" style="margin-left:2px;" class="btn btn-primary" data-toggle="modal" data-target="#confirm-rename" href="#">Rename</button>
        <button type="button" style="margin-left:2px;" class="btn btn-danger" data-toggle="modal" data-target="#confirm-delete" href="#">Delete</button>
         <button type="button" style="margin-left:2px;" class="btn btn-default" data-toggle="modal" data-target="#confirm-edit" href="#">Edit</button>

        <div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                Continue?
            </div>
            <div class="modal-body">
                Are you sure you want to delete image {{ image.name }} : {{ image.version }}?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <a href="/remove/{{ image.id }}" class="btn btn-danger danger">Delete</a>
            </div>
            </div>
            </div>
        </div>
        <div class="modal fade" id="confirm-edit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                Edit image
            </div>
            <div class="modal-body">
                Edit the information, it will be sent by post request to the server, and the database will be updated with the new info. 
                <form role="form" action="/edit" method="POST">
                    <div class="form-group">
                        <label for="exampleInputEmail1">Architecture</label>
                        <input id="archField" type="text" class="form-control" id="exampleInputEmail1" placeholder="Enter architecture here" value="{{ image.arch }}">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputPassword1">Keywords</label> (Make sure keywords are separated with a @)
                        <input id="keywordsField" type="text" class="form-control" id="exampleInputPassword1" placeholder="Enter @SV here" value="{{ image.keywords }}">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <a onclick="edit()" class="btn btn-primary">Submit</a>
            </div>
            </div>
            </div>
        </div>
        <div class="modal fade" id="confirm-rename" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                What would you like to rename <strong>{{ image.user }}/{{ image.name }}:{{ image.version }}</strong> to? <br/>Warning: renaming might take a long time, due to possible having to pull and repush an image to S3.

            </div>
            <div class="modal-body">
                
                <input type="text" name="user" id="userField" value="{{ image.user }}"><strong>/</strong></input><input type="text" name="name" id="nameField" value="{{ image.name }}"><strong>:</strong></input><input type="text" name="version" id="versionField" value="{{ image.version }}"></input>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" onclick="rename()" id="renameButton" class="btn btn-primary" >Rename</button>
            </div>
            </form>
            </div>
            </div>
        </div>
    </div>
    <div style="clear: both;"></div>
</div> 
{% endblock %}

{% block content %}
 <table class="table table-striped table-hover mytable" style="margin-left:20px;">
    <colgroup>
        <col span="1" style="width: 33%;">
        <col span="1" style="width: 67%;">
    </colgroup>
 	<thead>
 		<tr>
 			<th>Property</th>
 			<th>Value</th>
 		</tr>
 	</thead>
 	<tbody>
 		<tr>
 			<td>Name</td>
 			<td>{{ image.name }}</td>
 		</tr>
 		<tr>
 			<td>Version</td>
 			<td>{{ image.version }}</td>
 		</tr>
 		<tr>
 			<td>User</td>
 			<td><a href="/user/{{ image.user }}">{{ image.user }}</a></td>
 		</tr>
 		<tr>
 			<td>Date submitted</td>
 			<td>{{ image.date }}</td>
 		</tr>
        <tr>
            <td>Time submitted</td>
            <td>{{ image.time_secs }}</td>
        </tr>
 		<tr>
 			<td>Architecture</td>
 			<td>{{ image.arch }} </td>
 		</tr>
 		<tr>
 			<td>Image id (SHA hash)</td>
 			<td>{{ image.sha}}</td>
 		</tr> 		
 		<tr>
 			<td>Image size</td>
 			<td>{{ image.size }}</td>
 		</tr> 
        <tr>
            <td>Keywords</td>
            <td>
                {% if image.keywords %}
                    {% for keyword in image.keywords | split_ampersand %} 
                        <a href="/search?username=none&amp;input=keywords%3A{{ keyword }}">{{ keyword }}</a> &nbsp;&nbsp;
                    {% endfor %}
                {% else %}
                    None
                {% endif %}
            </td>
        </tr> 
        <tr>
            <td>Parent image</td>
            <td>
                {% if image.has_parent%}
                    <a href="/image/{{ image.parent }}">{{ image.parent }}</a>
                {% else%}
                    None
                {% endif%}
            </td>
        </tr>	
 	</tbody>
 </table>

{% endblock %}